<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Email Automator Dashboard</title>
    <link rel="stylesheet" href="/static/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        .mode-badge {
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .mode-new {
            background: #e0f2fe;
            color: #0369a1;
            border: 1px solid #bae6fd;
        }

        .mode-followup {
            background: #fdf4ff;
            color: #a21caf;
            border: 1px solid #f5d0fe;
        }

        .mode-weekend {
            background: #f3f4f6;
            color: #4b5563;
            border: 1px solid #e5e7eb;
        }

        .template-card {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .template-subject {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 4px;
        }

        .template-body {
            color: #64748b;
            white-space: pre-line;
            font-size: 0.85rem;
            max-height: 60px;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .tab-buttons {
            display: flex;
            gap: 12px;
            margin-bottom: 16px;
        }

        .tab-btn {
            padding: 8px 16px;
            border: none;
            background: transparent;
            color: #64748b;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            font-weight: 500;
        }

        .tab-btn.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }

        .template-list {
            display: none;
        }

        .template-list.active {
            display: block;
        }
    </style>
</head>

<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
                        <rect width="32" height="32" rx="8" fill="url(#gradient)" />
                        <path d="M8 12L16 18L24 12" stroke="white" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round" />
                        <rect x="7" y="10" width="18" height="12" rx="2" stroke="white" stroke-width="2" />
                        <defs>
                            <linearGradient id="gradient" x1="0" y1="0" x2="32" y2="32">
                                <stop offset="0%" style="stop-color:#667eea" />
                                <stop offset="100%" style="stop-color:#764ba2" />
                            </linearGradient>
                        </defs>
                    </svg>
                    <h1>Smart Email Automator</h1>
                </div>

                <div id="modeDisplay" class="mode-badge mode-weekend">
                    <span id="modeIcon">‚è∏</span>
                    <span id="modeText">Weekend Mode</span>
                </div>
            </div>
        </header>

        <!-- Stats Cards -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                        <path d="M22 12h-4l-3 9L9 3l-3 9H2" />
                    </svg>
                </div>
                <div class="stat-content">
                    <p class="stat-label">Initial Sent</p>
                    <h2 class="stat-value" id="sentEmails">0</h2>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon" style="background: linear-gradient(135deg, #8b5cf6 0%, #c4b5fd 100%);">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                        <polyline points="7 10 12 15 17 10" />
                        <line x1="12" y1="15" x2="12" y2="3" />
                    </svg>
                </div>
                <div class="stat-content">
                    <p class="stat-label">Follow-ups Stats</p>
                    <h2 class="stat-value" id="sentFollowups">0</h2>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                        <circle cx="12" cy="12" r="10" />
                        <polyline points="12 6 12 12 16 14" />
                    </svg>
                </div>
                <div class="stat-content">
                    <p class="stat-label">Pending</p>
                    <h2 class="stat-value" id="pendingEmails">0</h2>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                        <circle cx="12" cy="12" r="10" />
                        <line x1="15" y1="9" x2="9" y2="15" />
                        <line x1="9" y1="9" x2="15" y2="15" />
                    </svg>
                </div>
                <div class="stat-content">
                    <p class="stat-label">Failed</p>
                    <h2 class="stat-value" id="failedEmails">0</h2>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="content-grid">
            <!-- Left Column: Uploads & Control -->
            <div class="left-col" style="display: flex; flex-direction: column; gap: 24px;">
                <!-- Upload Section -->
                <div class="card">
                    <h3 class="card-title">üìÅ Data Management</h3>

                    <div class="upload-section">
                        <div class="upload-item">
                            <label class="upload-label">
                                <input type="file" id="csvFile" accept=".csv" hidden>
                                <div class="upload-box">
                                    <p class="upload-text">Upload List (CSV)</p>
                                    <span class="upload-hint">Click to browse</span>
                                </div>
                            </label>
                            <button class="btn-download" onclick="downloadTemplate()">Template</button>
                        </div>

                        <div class="upload-item">
                            <label class="upload-label">
                                <input type="file" id="pdfFile" accept=".pdf" hidden>
                                <div class="upload-box">
                                    <p class="upload-text">Attach Resume (PDF)</p>
                                    <span class="upload-hint" id="pdfStatus">Checking...</span>
                                </div>
                            </label>
                        </div>

                        <div class="upload-item">
                            <label class="upload-label">
                                <input type="file" id="credentialsFile" accept=".json" hidden>
                                <div class="upload-box">
                                    <p class="upload-text">Credentials.json</p>
                                    <span class="upload-hint" id="credentialsStatus">Checking...</span>
                                </div>
                            </label>
                        </div>

                        <div class="upload-item">
                            <label class="upload-label">
                                <input type="file" id="tokenFile" accept=".json" hidden>
                                <div class="upload-box">
                                    <p class="upload-text">Token.json (Optional)</p>
                                    <span class="upload-hint" id="tokenStatus">Checking...</span>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Send Section -->
                <div class="card send-section">
                    <div class="send-header">
                        <div>
                            <h3 class="card-title">üöÄ Campaign Control</h3>
                            <p class="send-description" id="campaignStatusText">System is ready.</p>
                        </div>
                    </div>

                    <div class="progress-container" id="progressContainer" style="display: none;">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"
                                style="width: 100%; animation: pulse 2s infinite;"></div>
                        </div>
                        <p class="progress-text">Campaign Running in Background...</p>
                    </div>

                    <button class="btn-send" id="sendButton" onclick="sendEmails()">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <line x1="22" y1="2" x2="11" y2="13" />
                            <polygon points="22 2 15 22 11 13 2 9 22 2" />
                        </svg>
                        Start Campaign
                    </button>

                    <div style="margin-top: 20px; padding-top: 16px; border-top: 1px solid #e2e8f0;">
                        <p style="font-size: 0.85rem; color: #64748b; margin-bottom: 8px;">üß™ <strong>Test
                                Connection</strong></p>
                        <div style="display: flex; gap: 8px;">
                            <input type="email" id="testEmailInput" placeholder="your@email.com"
                                style="flex: 1; padding: 8px 12px; border: 1px solid #cbd5e1; border-radius: 6px; font-size: 0.9rem;">
                            <button class="btn-download" onclick="sendTestEmail()" id="testBtn">Send</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column: Templates -->
            <div class="card">
                <h3 class="card-title">üîÑ Active Templates (Rotation)</h3>

                <div class="tab-buttons">
                    <button class="tab-btn active" onclick="switchTab('new')">New Emails (Tue-Thu)</button>
                    <button class="tab-btn" onclick="switchTab('followup')">Follow-ups (Mon/Fri)</button>
                </div>

                <div id="newTemplates" class="template-list active">
                    <!-- Templates injected via JS -->
                    <div class="template-card">Loading...</div>
                </div>

                <div id="followupTemplates" class="template-list">
                    <!-- Templates injected via JS -->
                </div>

                <div style="margin-top: 16px; font-size: 0.85rem; color: #64748b;">
                    <p>üí° <strong>Note:</strong> Templates are automatically rotated for each email to prevent blocking.
                        Edit <code>send_emails.py</code> to change them.</p>
                </div>
            </div>
        </div>

        <!-- Notifications -->
        <div class="notification" id="notification"></div>
    </div>

    <script src="/static/script.js"></script>
    <style>
        @keyframes pulse {
            0% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }

            100% {
                opacity: 1;
            }
        }
    </style>
</body>

</html>